#summary Cómo construir la herramienta de filtrado de datos
#sidebar TableOfContents

[http://code.google.com/p/iabin-threats/wiki/Configuration?wl=en http://iabin-threats.googlecode.com/svn/wiki/resources/gb.gif]
[http://code.google.com/p/iabin-threats/wiki/Configuration?wl=es http://iabin-threats.googlecode.com/svn/wiki/resources/es.gif]

<wiki:toc />

== Introducción ==

Este es un documento técnico y está destinado a personas con conocimientos técnicos en la ejecución de comandos java y mysql

El objetivo de este documento es ilustrar cómo construir el proyecto desde el código fuente de este repositorio.

== Requerimientos técnicos ==

	* Para este paso, el proyecto debe ser importado, editado y empaquetado. (ver sección [http://code.google.com/p/iabin-threats/wiki/HowToBuildITA Cómo construir el proyecto ITA])
	* 250GB-500GB de DD de espacio disponible para la base de datos (mientras se realiza el proceso de importación), 30GB para archivos shape y archivos de variables bioclimáticas. 
	* La última versión de JRE, disponible de forma gratuita en [http://www.java.com http://www.java.com] 
	* Servidor de base de datos de MySQL 
  		# La base de datos de GBIF montada y configurada basada en el archivo adjunto llamado my.cnf. Debe cambiar los parametros de datadir and tmpdir.


== Configurando la base de datos de MySQL ==
Puede usar cualquier otra configuración .Sin embargo, se recomienda la siguiente configuración:


{{{
[mysqld]
#datadir=/var/lib/mysql		 
datadir=/media/Lacie_Disk/mysql			
tmpdir=/media/Lacie_Disk/mysql_temp			
socket=/var/lib/mysql/mysql.sock
user=mysql
# Default to using old password format for compatibility with mysql 3.x
# clients (those using the mysqlclient10 compatibility package). 
old_passwords=1 
#bind-address=0.0.0.0 
port=3306
max_allowed_packet = 1M
table_cache = 512 
sort_buffer_size = 128M 
read_buffer_size = 64M 
read_rnd_buffer_size = 300M 
thread_cache_size = 8 
query_cache_type = 0 
query_cache_size = 0 
thread_concurrency = 16 
myisam_max_sort_file_size = 250G 
myisam_max_extra_sort_file_size = 250G 
# this is used for repair by sorting 
myisam_sort_buffer_size = 3990M 
# maximum value for this is 4g for now! 
key_buffer_size=3990M 
tmp_table_size=512M 
max_heap_table_size=512M 
 
[mysqld_safe] 
log-error=/var/log/mysqld.log 
pid-file=/var/run/mysqld/mysqld.pid
}}}
			


== Configurando Archivos ==

El proyecto necesita configurar algunos archivos XML extra antes de comenzar a usarlo (*client_config.xml* and *server_config.xml*).

como el comando _svn_ no importa estos archivos, el proyecto ITA puede generarlos asignando valores por defecto que se deben cambiar luego, dependiendo de su sistema y configuración personal.

Para generar los archivos basicos de configuración, ejecute los siguientes comandos:

     java -jar ita-0.1-SNAPSHOT.jar org.ciat.ita.client.ClientConfig
     
     java -jar ita-0.1-SNAPSHOT.jar org.ciat.ita.server.ServerConfig
     
Ambos XML deberían haberse creado.

-----------------------------------------------------

|| server_config.xml ||

{{{
<?xml version="1.0" encoding="UTF-8"?>
<config>
  <rmi port="1099" />
  <database name="portal" ip_addr="localhost" port="3306">
    <user name="server">db_user</user>
    <password user="server">*******</password>
    <tables>
      <table content="unverified_records">temp_land_5A</table>
      <table content="good_records">
        temp_good_records
        <column content="variable">alt</column>
        <column content="variable">bio_1</column>
        <column content="variable">bio_2</column>
        <column content="variable">bio_3</column>
        <column content="variable">bio_4</column>
        <column content="variable">bio_5</column>
        <column content="variable">bio_6</column>
        <column content="variable">bio_7</column>
        <column content="variable">bio_8</column>
        <column content="variable">bio_9</column>
        <column content="variable">bio_10</column>
        <column content="variable">bio_11</column>
        <column content="variable">bio_12</column>
        <column content="variable">bio_13</column>
        <column content="variable">bio_14</column>
        <column content="variable">bio_15</column>
        <column content="variable">bio_16</column>
        <column content="variable">bio_17</column>
        <column content="variable">bio_18</column>
        <column content="variable">bio_19</column>
        <column content="outlier_count">outlier</column>
      </table>
      <table content="final_records">filtered_records</table>
      <table content="unrelible_records">temp_bad_records</table>
    </tables>
  </database>
</config>
}}}

*rmi port*: El puerto RMI Por defecto. Puede eliminar esta etiqueta si se va a ejecutar la aplicación con una configuración "LOCAL".

*Base de datos*:
 * *name*: Nombre de la base de datos
 * *ip_addr*: Dirección IP de la base de datos
 * *port*: Puerto de la base de datos
 
*user name*: Usuario de la base de datos. (Debe cambiar el valor por defecto _db_user_).

*password user*: Contraseña de la base de datos. (Cambie los asteriscos _******_).

*tablas*:
 * *unverified_records*: En caso de que haya cambiado los nombres de las tablas en los scripts SQL, cambie los nombres de las tablas (temp_land_5A) por los correctos.
 * *good_records*: Igual que el anterior el nombre por defecto es _temp_good_records_.
 * *final_records*:  Igual que el anterior el nombre por defecto es _filtered_records_
 * *unrelible_records*:  Igual que el anterior el nombre por defecto es _temp_bad_records_
-----------------------------------------------------

|| client_config.xml ||

{{{
<?xml version="1.0" encoding="UTF-8" ?>
<config>
  <server ip_addr="localhost" communication_type="LOCAL" />
  <Proxy>
    <HttpProxy server="proxy4.ciat.cgiar.org" port="8080" />
  </Proxy>
  <work records="10000" />
  <shape path="/GADM_v0-6.shp">
    <column name="ISO">ISO</column>
    <column name="country">ISOCOUNTRY</column>
    <column name="state">NAME_1</column>
    <column name="county">NAME_2</column>
  </shape>
  <mask path="/inland_msk.jgm" />
  <maxent>
    <file name="maxent_file" type="jar" path="/maxent.jar" />
    <file name="sample_dir" type="directory" path="/samples/" />
    <file name="backgroung_file" type="csv" path="/background_clm.csv" />
    <file name="lambda_output_dir" type="directory" path="/lambda_output/" />
    <file name="final_output_dir" type="directory" path="/final_output/" />
    <file name="bio_variables_dir" type="directory" path="/small_variables/" />
  </maxent>
  <variables type="bioclimatic" path="/variables/">
    <variable>alt</variable>
    <variable>bio_1</variable>
    <variable>bio_2</variable>
    <variable>bio_3</variable>
    <variable>bio_4</variable>
    <variable>bio_5</variable>
    <variable>bio_6</variable>
    <variable>bio_7</variable>
    <variable>bio_8</variable>
    <variable>bio_9</variable>
    <variable>bio_10</variable>
    <variable>bio_11</variable>
    <variable>bio_12</variable>
    <variable>bio_13</variable>
    <variable>bio_14</variable>
    <variable>bio_15</variable>
    <variable>bio_16</variable>
    <variable>bio_17</variable>
    <variable>bio_18</variable>
    <variable>bio_19</variable>
  </variables>
</config>
}}}

*ip_addr*:  Dirección IP del servidor MySQL

*communication_type*:
 * _LOCAL_ Para ejecutar el script de forma local (Cliente y servidor en la misma máquina) - _Opción recomendada_.
 * _RMI_ Para ejecutar el escript como configuración remota (Un Servidor - Muchos Clientes).

*HttpProxy server and port*: En caso de que su conexión a internet pase por un Proxy. De lo contrario, puede eliminar todos las etiquetas {{{<Proxy>}}}.

*work records*:  Número de registros a ser evaluado por lote.

*shape*: 
 * *path*: Forma Global y detallada del archivo shape. Se recomienda descargar de [http://gisweb.ciat.cgiar.org/ITA/public_downloads/GADM_v0-6.zip este archivo]
 * *column*:  Cada una de las columnas que tiene el archivo Shape.
 Para más información a cerca de archivos Shape [http://en.wikipedia.org/wiki/Shapefile click aquí].

*mask*: Ubicación del archivo de máscara que contiene información de cada coordenada, Si la cobertura es en la tierra o el agua. El archivo se puede descargar [http://gisweb.ciat.cgiar.org/ITA/public_downloads/inland_msk.zip aquí]

*maxent*: La configuración de Maxent puede omitirse, este campo se utilizará en la ejecución posterior del proyecto.

*variables path*: Localización de variables Bioclimáticas. Puede encontrar las 20 variables [http://gisweb.ciat.cgiar.org/ITA/public_downloads/BioAIO.zip aquí].

-----------------------------------------------------

Una vez que el archivo de configuración se ha hecho correctamente, puede empezar a correr cada uno de los scripts que se presenta en esta sección.