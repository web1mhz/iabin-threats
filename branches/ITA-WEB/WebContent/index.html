<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es">
	<head>
		<title>Menu Especies</title>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
		<link rel="stylesheet" type="text/css" href="css/default.css" />
		
		<script type="text/javascript"
			src="http://code.jquery.com/jquery-1.4.4.js"></script>	
			
		<script type="text/javascript">
			$(document).ready(function() {				
				$(".element").click(function(event) {								 
					$target = $(event.target).parent();
					if($("#" + $target.attr("id")+" ul").attr("id") == undefined) {
						// run ajax
						$.ajax({
							url: "service.do",
							dataType: "json",
							data: "id="+$target.attr("id")+"&rank="+$target.attr("rank"),
							beforeSend: function(data) {
								$loaderGift = $("#loaderGift").clone().show();
								$target.append($loaderGift);
							},
							success: function(data) {								
								$.each(data, function(i, taxon) {
									var title="Family";
									if(taxon.rankID==6000){
										title="Genus";
									} else {
										if(taxon.rankID==7000) {
											title="Specie";
										}
									}									
									$target.append("<ul><li id="+taxon.id+" rank="+taxon.rankID+
										" class=element><a href=# ><Strong>"+title+"</Strong>"+" "+taxon.canonical+"</a></li></ul>");
								});								
							},
							complete: function(data, code) {
								if(code == "success") {
									$("#"+$target.attr("id")+" #loaderGift").remove();	
								}
							},
							error: function(data, error, objectError) {
								// Aun falta implementar lo que sucederá cuando hay un error
								alert("error: "+error);
								$("#"+$target.attr("id")+" #loaderGift").remove();
							}
						}); // END ajax
					} else {
						// content already exist
						// is visible?
						if ($("#" + $target.attr("id")).children("ul").is(":visible")) {
							// if is visible slide up and hide the content.
							
							//$("ul li a").css({'width':'120px','background':'url(http://www.gstatic.com/codesite/ph/images/plus.gif) no-repeat 10px center','padding-left':'25px'});
							$("#contenidoDemo #contenidoDemo1").css({'width':'120px','background':'url(http://www.gstatic.com/codesite/ph/images/minus.gif) no-repeat 10px center','padding-left':'25px'});
							$("#contenidoDemo #animalia").css({'width':'120px','background':'url(http://www.gstatic.com/codesite/ph/images/minus.gif) no-repeat 10px center','padding-left':'25px'});
							$("#" + $target.attr("id")).children("ul").slideUp('fast');
						} else {
							// if is not visible slide down and show the content.
							$("#" + $target.attr("id")).children("ul").slideDown('fast');
							$("ul li a").css({'width':'120px','background':'url(http://www.gstatic.com/codesite/ph/images/minus.gif) no-repeat 10px center','padding-left':'25px'});			
						}
					}					
				});	// END click 
			}); //END ready
		
		
		</script>
	</head>
	<body onload="">
		<div id="contenidoDemo">
			<h2>Species Menu</h2>
		<ul>
				<li id="149476" rank="1000" class="element"><a href="#"><Strong>Kingdom</Strong> Plantae</a></li>
				<li  class="element"><a href="#" id="animalia"><Strong>Kingdom</Strong> Animalia</a></li>
					<ul>
						<li><a href="#" id="contenidoDemo1"><Strong>Phylum</Strong> Chordata</a>
							<ul>
								<li id="221704" rank="3000" class="element"><a href="#"><Strong>Class</Strong> Amphibia</a></li>
								<li id="221705" rank="3000" class="element"><a href="#"><Strong>Class</Strong> Aves</a></li>
								<li id="223922" rank="3000" class="element"><a href="#"><Strong>Class</Strong> Mammalia</a></li>
								<li id="223924" rank="3000" class="element"><a href="#"><Strong>Class</Strong> Reptilia</a></li>	
							</ul>
						</li>
					</ul>
					<ul>	
						<li><a href="#" id="contenidoDemo1"><Strong>Phylum</Strong> Arthropoda</a>
							<ul>
						        <li id="149449" rank="3000" class="element"><a href="#"><Strong>Class</Strong> Insecta</a></li>
					        </ul>
					    </li>    
					</ul>
		</ul>
		</div>
	</body>
	<img id="loaderGift" src="images/ajax-loader.gif" style="display:none;" />
</html>